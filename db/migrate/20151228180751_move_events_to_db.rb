class MoveEventsToDb < ActiveRecord::Migration
  def up
  @events = [
    {:banner => 'events_2015/12012015_WebAppPreview.png',
      :event_date => '2015-12-02',
      :name => 'Web App Tutorial Preview - Winter 2016',
      :facebook_link => 'https://www.facebook.com/events/1725731107645805/'},
    {:banner => 'events_2015/shopify_fall_2015_event_banner.jpg',
      :name => 'Shopify on Campus - Winternships are Coming!',
      :event_date => '2015-12-02',
      :facebook_link => 'https://www.facebook.com/events/552764481544976/'},
    {:banner => 'IBMHackathon.jpg',
      :name => 'IBM Hackathon',
      :event_date => '2015-11-02',
      :facebook_link => 'https://www.facebook.com/events/1040902412611160/'},
    {:banner => 'Google_Talk_October_2015.jpg',
      :name => 'Google Talk',
      :event_date => '2015-10-21',
      :facebook_link => 'https://www.facebook.com/events/1161529577209002/'},
    {:banner => 'events_2015/shopify_fall_2015_event_banner.jpg',
      :name => 'Shopify Winternship Talk',
      :event_date => '2015-09-29',
      :facebook_link => 'https://www.facebook.com/events/758756164250040/'},
    {:banner => 'GoogleIO15.jpg',
      :name => 'Google I/O Extended',
      :event_date => '2015-05-28',
      :facebook_link => 'https://www.facebook.com/events/872090266182143/'},
    {:banner => 'GoogleMapsTalk.jpg',
      :name => 'Google Maps Talk Banner',
      :event_date => '2015-03-23',
      :facebook_link => 'https://www.facebook.com/events/696751373767860/'},
    {:banner => 'RoR_Winter2015.jpg',
      :name => 'Ruby on Rails Winter 2015 Tutorial Banner',
      :event_date => '2015-02-02',
      :facebook_link => 'https://www.facebook.com/events/778999418859343/'},
    {:banner => 'coding_competition.jpg',
      :name => 'Coding Competition Banner',
      :event_date => '2015-03-14',
      :facebook_link => 'https://www.facebook.com/events/799369220151246/'},
    {:banner => 'startup-weekend-banner.jpg',
      :name => 'Startup Weekend UOttawa Banner',
      :event_date => '2015-02-27',
      :facebook_link => 'https://www.facebook.com/events/774386012655259/'},
    {:banner => 'shopify_coop_talk_banner.jpg',
      :name => 'Shopify Coop Talk Banner',
      :event_date => '2015-02-09',
      :facebook_link => 'https://www.facebook.com/events/1525471497740725/'},
    {:banner => 'Mock_Interviews_Winter2015.jpg',
      :name => 'Programming Mockup Interviews Winter 2015',
      :event_date => '2015-01-26',
      :facebook_link => 'https://www.facebook.com/events/324991577708081/'},
    {:banner => 'legacy.jpg',
      :name => 'Legacy Conference Fall 2014',
      :event_date => '2014-11-22',
      :facebook_link => 'https://www.facebook.com/events/712288775553750/'},
    {:banner => 'elads-event.jpg',
      :name => 'Business Card Design Workshop Banner',
      :event_date => '2014-11-10',
      :facebook_link => 'https://www.facebook.com/events/307282269474878/'},
    {:banner => 'sitebannerevent.jpg',
      :name => 'Tech Talk',
      :event_date => '2014-11-06',
      :facebook_link => 'https://www.facebook.com/events/732469863508791/'},
    {:banner => 'Photoshop_Workshop_Fall2014.jpg',
      :name => 'Photoshop Workshop Banner',
      :event_date => '2014-09-28',
      :facebook_link => 'https://www.facebook.com/events/433031483502586/'},
    {:banner => 'ruby_tutorial_banner.jpg',
      :name => 'Ruby on Rails Tutorial Banner',
      :event_date => '2014-10-01',
      :facebook_link => 'https://www.facebook.com/events/521381771297707/'},
    {:banner => 'meetNgreet_Fall2014.jpg',
      :name => 'Meet and Greet Fall 2014 Banner',
      :event_date => '2014-09-12',
      :facebook_link => 'https://www.facebook.com/events/1475488029380249/'},
    {:banner => 'barbecuebanner1.jpg',
      :name => 'Barbecue Banner',
      :event_date => '2014-06-27',
      :facebook_link => 'https://www.facebook.com/events/255970374595125/'},
    {:banner => '2DJava.jpg',
      :name => '2D Java Game',
      :event_date => '2015-11-05',
      :facebook_link => 'https://www.facebook.com/events/491126517732587/'}]
    b64_encoded_images = []
    @events.each do |event|
      banner_location = Rails.root.join('app', 'assets', 'images', event[:banner])
      event[:banner] = banner_location
      file_content = open(banner_location) {|f| f.read}
      event[:banner_b64] = Base64.encode64(file_content)
    end
    @events.each do |event|
      Event.create(
        name: event[:name],
        facebook_link: event[:facebook_link],
        banner: event[:banner_b64],
        event_date: event[:event_date])
    end
    # add an index on name
    add_index :events, :name
  end

  def down
    @events = [
    {:banner => 'events_2015/12012015_WebAppPreview.png',
      :event_date => '2015-12-02',
      :name => 'Web App Tutorial Preview - Winter 2016',
      :facebook_link => 'https://www.facebook.com/events/1725731107645805/'},
    {:banner => 'events_2015/shopify_fall_2015_event_banner.jpg',
      :name => 'Shopify on Campus - Winternships are Coming!',
      :event_date => '2015-12-02',
      :facebook_link => 'https://www.facebook.com/events/552764481544976/'},
    {:banner => 'IBMHackathon.jpg',
      :name => 'IBM Hackathon',
      :event_date => '2015-11-02',
      :facebook_link => 'https://www.facebook.com/events/1040902412611160/'},
    {:banner => 'Google_Talk_October_2015.jpg',
      :name => 'Google Talk',
      :event_date => '2015-10-21',
      :facebook_link => 'https://www.facebook.com/events/1161529577209002/'},
    {:banner => 'events_2015/shopify_fall_2015_event_banner.jpg',
      :name => 'Shopify Winternship Talk',
      :event_date => '2015-09-29',
      :facebook_link => 'https://www.facebook.com/events/758756164250040/'},
    {:banner => 'GoogleIO15.jpg',
      :name => 'Google I/O Extended',
      :event_date => '2015-05-28',
      :facebook_link => 'https://www.facebook.com/events/872090266182143/'},
    {:banner => 'GoogleMapsTalk.jpg',
      :name => 'Google Maps Talk Banner',
      :event_date => '2015-03-23',
      :facebook_link => 'https://www.facebook.com/events/696751373767860/'},
    {:banner => 'RoR_Winter2015.jpg',
      :name => 'Ruby on Rails Winter 2015 Tutorial Banner',
      :event_date => '2015-02-02',
      :facebook_link => 'https://www.facebook.com/events/778999418859343/'},
    {:banner => 'coding_competition.jpg',
      :name => 'Coding Competition Banner',
      :event_date => '2015-03-14',
      :facebook_link => 'https://www.facebook.com/events/799369220151246/'},
    {:banner => 'startup-weekend-banner.jpg',
      :name => 'Startup Weekend UOttawa Banner',
      :event_date => '2015-02-27',
      :facebook_link => 'https://www.facebook.com/events/774386012655259/'},
    {:banner => 'shopify_coop_talk_banner.jpg',
      :name => 'Shopify Coop Talk Banner',
      :event_date => '2015-02-09',
      :facebook_link => 'https://www.facebook.com/events/1525471497740725/'},
    {:banner => 'Mock_Interviews_Winter2015.jpg',
      :name => 'Programming Mockup Interviews Winter 2015',
      :event_date => '2015-01-26',
      :facebook_link => 'https://www.facebook.com/events/324991577708081/'},
    {:banner => 'legacy.jpg',
      :name => 'Legacy Conference Fall 2014',
      :event_date => '2014-11-22',
      :facebook_link => 'https://www.facebook.com/events/712288775553750/'},
    {:banner => 'elads-event.jpg',
      :name => 'Business Card Design Workshop Banner',
      :event_date => '2014-11-10',
      :facebook_link => 'https://www.facebook.com/events/307282269474878/'},
    {:banner => 'sitebannerevent.jpg',
      :name => 'Tech Talk',
      :event_date => '2014-11-06',
      :facebook_link => 'https://www.facebook.com/events/732469863508791/'},
    {:banner => 'Photoshop_Workshop_Fall2014.jpg',
      :name => 'Photoshop Workshop Banner',
      :event_date => '2014-09-28',
      :facebook_link => 'https://www.facebook.com/events/433031483502586/'},
    {:banner => 'ruby_tutorial_banner.jpg',
      :name => 'Ruby on Rails Tutorial Banner',
      :event_date => '2014-10-01',
      :facebook_link => 'https://www.facebook.com/events/521381771297707/'},
    {:banner => 'meetNgreet_Fall2014.jpg',
      :name => 'Meet and Greet Fall 2014 Banner',
      :event_date => '2014-09-12',
      :facebook_link => 'https://www.facebook.com/events/1475488029380249/'},
    {:banner => 'barbecuebanner1.jpg',
      :name => 'Barbecue Banner',
      :event_date => '2014-06-27',
      :facebook_link => 'https://www.facebook.com/events/255970374595125/'},
    {:banner => '2DJava.jpg',
      :name => '2D Java Game',
      :event_date => '2015-11-05',
      :facebook_link => 'https://www.facebook.com/events/491126517732587/'}]
    @events.each do |event|
      Event.find_by_name(event[:name]).delete
    end
    #remove index
    remove_index :events, :name
  end
end
